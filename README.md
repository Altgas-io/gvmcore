# Проект симулятора Ethereum Virtual Machine


## Начальная настройка проекта

* Для начала работы после клонирования проекта требуется единожды запустить скрипт (**ВНИМАНИЕ**, требуется ввести **пароль** от sudo):
```
./first-start
```
будет выполнено подключение необходимых модулей, а также установлены необходимые пакеты для сборки и работы симуляторов **go-ethereum**, **cemu** и **qemu**.


## Сборка проекта

* Для сборки проекта необходимо выполнить:
```
./build-all
```  
будут собраны симуляторы **go-ethereum**, **cemu** и **qemu**, а также тесты системы тестирования.

* Индикацией успешной сборки будет наличие:
  1. бинарных файлов симуляторов:
      * *ethereum/build/bin/evm*
      * *emulator/bins/cemu*
      * *QEMU/qemu/ppdl-softmmu/qemu-system-ppdl*
  2. библиотек архитектуры:
      * *emulator/models/evm/simulator/evm.so*
      * *QEMU/qemu/ppdl-softmmu/libevm-ppdl.so*
  3. бинарных файлов тестов:
      * *tests/asm/test_name/test_name.bin*


## Тестирование


### Запуск полного тестирования со сравнением

Для запуска тестов необходимо перейти в каталог *tests/asm/* и выполнить одну из команд:
```
make compare
make test-cemu
make test-qemu
```  

Система запустит поочередно каждый тест в двух симуляторах, сравних выходные данные и выдаст результат теста:

* `make compare` запускает сравнение QEMU vs CEMU
* `make test-cemu` запускает сравнение CEMU vs EVM
* `make test-qemu` запускает сравнение QEMU vs EVM

По завершении тестирования будет дана сводка по количеству пройденных тестов в формате:
```
Test Result Summary:
    PASS: XXX
    FAIL: YYY
```


### Запуск отдельных тестов на симуляторе

Можно проводить запуск конкретных тестов на каком-либо симуляторе. Для этого необходимо перейти в каталог теста (напр., *tests/asm/add/*) и выполнить одну из команд:
```
make run-qemu
make run-cemu
make run-evm
```

Будет произведен запуск теста на соответствующем симуляторе и показан результат работы.
*Примечание:* опции запуска симуляторов описаны в файле *tests/asm/Makefile.in* в соответствующих секциях.
