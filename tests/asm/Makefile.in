COMPILER = solc

ASMSRC = ${wildcard *.asm}
SOLOUT = ${ASMSRC:.asm=.out}

all: ${TARGET}

${TARGET}: ${SOLOUT} Makefile
	cat ${SOLOUT} | grep -A1 "Binary \representation:" | awk 'NR==2' > $@.bin

%.out: %.asm Makefile
	${COMPILER} --assemble $< > $@

run: ${TARGET}
	../../../ethereum/build/bin/evm --code `cat ${TARGET}.bin` run

clean:
	rm -f ${TARGET}.bin ${SOLOUT}
